# 에러 및 정리

> 게시판 만들면서 발생한 에러나 잘 몰랐던 내용을 정리한 파일



## 에러

```
Is the server running on host "localhost" (127.0.0.1) and accepting
TCP/IP connections on port 5432?
```

[에러] `./manage.py runserver`를 하면 위와 같은 에러가 발생

[해결] [이곳](https://stackoverflow.com/questions/37307346/is-the-server-running-on-host-localhost-1-and-accepting-tcp-ip-connections)을 참조하여 PostgreSQL 설치로 해결



```
null value in column "author_id" violates not-null constraint
```

`[에러]` 새로운 포스트를 만들려고 했을 때 발생

`[해결]`  Post 모델에서 author 필드가 `blank=True null=True`가 아니기에 해당 로그인한 유저의 정보를 같이 줘야 함

```python
if form.is_valid():
    post = form.save(commit=False)
    post.author = request.user
    post.save()
```



```
Unsafe redirect to URL with protocol 'posts'
```

[에러] `return redirect('posts:post_list.html')` 입력을 하면서 위 에러가 발생

[해결] `return redirect('posts:post_list')` 로 해결



```
duplicate key value violates unique constraint "members_user_username_key"
```

[해결] 



```python
# views.py
def logout(request):
    if request.method == 'POST':
        logout(request)
        return redirect('posts:post_list')
    
# base.html
{% raw %}
{% if user.is_authenticated %}
    <form action="" method="POST">
    {% csrf_token %}
    <li><a href="{% url 'members:logout' %}">로그아웃</a></li>
    </form>
{% endif %}
{% endraw %}
```

[에러] `The view members.views.logout didn't return an HttpResponse object. It returned None instead.` 

[해결] `<li><button type="submit">로그아웃</button></li>` 





## 정리

```python
def post_list(request):
    posts = Post.objects.all()
    search= request.GET.get('search', '')
    if search:
        posts = posts.filter(title__icontains=search)
    context = {
        'posts': posts,
        'search': search,

    }
    return render(request, 'posts/post_list.html', context)
```

The `request` object contains information about the user's request. What data they've sent to the page, where they are coming from, etc. `request.GET` contains the GET variables. These are what you see in your browser's address bar. The `.get()` method is a method used for dictionaries. What your snippet of code is doing is saying, "Get the value of a GET variable with name 'page', and if it doesn't exist, return 1". Likewise, you will see `request.POST` used when a user submits a form. 라고 [스택 오버 플로우](https://stackoverflow.com/questions/44598962/what-does-request-get-get-means)에 답변이 달려있다. 유저가 검색창에 무언가를 입력한다면 `search`에 그 무언가가 들어가게 되지만, 그렇지 않다면 두 번째  `''` 값이 들어가게 된다.



```
{% raw %}
{% if user.is_authenticated %}
    content 
{% endif %}
{% endraw %}
```

로그인한 유저만 글을 작성한다, 수정한다와 같은 경우일 때 사용하면 된다.

